{"version":3,"file":"commonHelpers.js","sources":["../src/js/cart-page-js/cart-js.js","../src/js/cart-page-js/cart-order-list.js","../src/js/cart-page-js/cart-total.js"],"sourcesContent":["const KEY = 'cartItems';\n\nconst cartConteiner = document.querySelector('.js-cart');\nconst headerCounter = document.querySelector('.header__js_span');\n// cartConteiner.addEventListener('click', handlerClickPlus);\n\nfunction handlerClickPlus(e) {\n  const button = e.target.closest('.item-plus');\n  if (!button) {\n    return;\n  }\n  // <li class=\"cart-order-item\" data-id=\"id_product\"></li>\n  const itemId = e.target.closest('.cart-order-item').dataset.id;\n  const updateCartItems = loadStorage(KEY);\n  const idx = updateCartItems.findIndex(element => element.id === itemId);\n  updateCartItems[idx].quantity += 1;\n  //шлях до спану\n  el.textContent = updateCartItems[idx].quantity;\n  //змінити контент елемента відображення к-ті товару\n  saveStorage(KEY, updateCartItems);\n}\n\nfunction handlerClickMinus(e) {\n  const button = e.target.closest('.item-minus');\n  if (!button) {\n    return;\n  }\n  // <li class=\"cart-order-item\" data-id=\"id_product\"></li>\n  const itemId = e.target.closest('.cart-order-item').dataset.id;\n  const updateCartItems = loadStorage(KEY);\n  const idx = updateCartItems.findIndex(element => element.id === itemId);\n  if (updateCartItems[idx].quantity === 0) {\n    return;\n  } else {\n    updateCartItems[idx].quantity -= 1;\n    //шлях до спану\n    el.textContent = updateCartItems[idx].quantity;\n  }\n  //змінити контент елемента відображення к-ті товару\n  saveStorage(KEY, updateCartItems);\n}\n\nconst saveStorage = (key, value) => {\n  try {\n    const serializedState = JSON.stringify(value);\n    localStorage.setItem(key, serializedState);\n  } catch (error) {\n    console.error('Set state error: ', error.message);\n  }\n};\n\nexport const loadStorage = key => {\n  try {\n    const serializedState = localStorage.getItem(key);\n    return serializedState === null ? undefined : JSON.parse(serializedState);\n  } catch (error) {\n    console.error('Get state error: ', error.message);\n  }\n};\n\nfunction changeCounter() {\n  if (!loadStorage(KEY)) {\n    headerCounter.textContent = `CART (${0})`;\n  } else {\n    headerCounter.textContent = `CART (${loadStorage(KEY).length})`;\n  }\n}\n\n//зміна к-ті продуктів в хідері при завантаженні вікна\nwindow.addEventListener('load', changeCounter);\n","import sprite from '/img/sprite.svg';\n\nconst orderList = document.querySelector('.cart-order-list'),\n  cartListSection = document.querySelector('.cart-filled-list'),\n  cartEmptySection = document.querySelector('.cart-empty'),\n  clearCartBtn = document.querySelector('.cart-clear-btn'),\n  cartCount = document.querySelector('.cart-count'),\n  cartTotalRight = document.querySelector('.cart_total_order'),\n  headerCounter = document.querySelector('.header__js_span'),\n  totalElement = document.getElementById('cart_total');\n\n//  LS manipulation\nlet cart = JSON.parse(localStorage.getItem('cartItems')) || [];\n\nfunction updateLocalStorage() {\n  localStorage.setItem('cartItems', JSON.stringify(cart));\n}\n\n// Start Render section ******************\ndocument.addEventListener('DOMContentLoaded', () => {\n  renderCartItem();\n  updateTotalPrice();\n  changeListLength();\n\n  orderList.addEventListener('click', handleCartClick);\n  clearCartBtn.addEventListener('click', handleClearCart);\n});\n\nfunction changeListLength() {\n  if (!cart.length) {\n    headerCounter.textContent = `Cart (${0})`;\n    cartCount.textContent = `Cart (${0})`;\n  } else {\n    cartCount.textContent = `Cart (${cart.length})`;\n    headerCounter.textContent = `Cart (${cart.length})`;\n  }\n}\n\nfunction cartOrder(cart) {\n  return cart\n    .map(\n      item => `\n  <li class=\"cart-order-item\">\n    <div class=\"cart-item-content\">\n      <div class=\"cart-order-img-cont\">\n        <img\n          class=\"cart-order-img\"\n          src=\"${item.img}\"\n          alt=\"${item.imgDsc}\"\n           aria-label=\"product\"\n        />\n      </div>\n      <div class=\"cart-order-desc\">\n        <div class=\"cart-order-title-btn\">\n          <h3 class=\"cart-order-title\">${item.title}</h3>\n          <button class=\"cart-remove-btn\" type=\"button\"  aria-label=\"remove-product\">\n            <span class=\"cart-remove-span\">\n              <svg class=\"cart-remove-icon\" width=\"18\" height=\"18\">\n                <use\n                  class=\"cart-remove-svg\"\n                  xlink:href=\"${sprite}#close-cross\"\n                ></use>\n              </svg>\n            </span>\n          </button>\n        </div>\n        <p class=\"cart-order-text\">\n          <span class=\"cart-order-span\">Category:</span>${item.category}\n          <span class=\"cart-order-span cart-gap\">Size:</span>\n          ${item.size}\n        </p>\n        <div class=\"cart-order-total-price\">\n          <span class=\"cart-order-price\">$${(\n            parseFloat(item.price.replace('$', '')) * item.quantity\n          ).toFixed(2)}</span>\n          <div class=\"cart-order-amount\">\n            <button class=\"cart-order-decr\" type=\"button\" aria-label=\"decrement\"><svg class=\"minus-icon\" width=\"18\" height=\"18\" aria-label=\"minus\">\n                <use\n                  class=\"cart-remove-svg\"\n                  xlink:href=\"${sprite}#minus\"\n\n                ></use>\n              </svg></button>\n            <span class=\"cart-order-quantity\">${item.quantity}</span>\n            <button class=\"cart-order-incr\" type=\"button\" aria-label=\"increment\"><svg class=\"plus-icon\" width=\"18\" height=\"18\" aria-label=\"plus\">\n                <use\n                  class=\"cart-remove-svg\"\n                  xlink:href=\"${sprite}#plus\"\n                ></use>\n              </svg></button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </li>\n  `\n    )\n    .join('');\n}\n\nfunction renderCartItem() {\n  if (cart.length) {\n    orderList.innerHTML = cartOrder(cart);\n  } else {\n    cartEmptySection.classList.remove('visually-hidden');\n    cartTotalRight.classList.add('visually-hidden');\n    cartListSection.classList.add('visually-hidden');\n  }\n}\n// End Render section ********************\n\n// Minus quantity in cart\nfunction handleDecrCount(target) {\n  const cartItem = target.closest('.cart-order-item');\n  const index = Array.from(orderList.children).indexOf(cartItem);\n\n  if (cart[index].quantity > 1) {\n    cart[index].quantity -= 1;\n    updateCartItem(cartItem, cart[index]);\n  }\n}\n\n// Plus quantity in cart\nfunction handleIncrCount(target) {\n  const cartItem = target.closest('.cart-order-item');\n  const index = Array.from(orderList.children).indexOf(cartItem);\n\n  cart[index].quantity += 1;\n  updateCartItem(cartItem, cart[index]);\n}\n\n// Remove cart-item\nfunction handleRemoveItem(e) {\n  const cartItem = e.target.closest('.cart-order-item');\n  if (cartItem) {\n    const index = Array.from(orderList.children).indexOf(cartItem);\n\n    const removedItem = cart.splice(index, 1)[0];\n    updateLocalStorage();\n\n    cartItem.remove();\n    updateTotalPrice();\n    renderCartItem();\n    changeListLength();\n  }\n}\n\norderList.addEventListener('click', e => {\n  if (e.target.closest('.cart-remove-btn')) {\n    handleRemoveItem(e);\n  }\n});\n\n// Remove cart-list\nfunction handleClearCart() {\n  cart = [];\n  orderList.innerHTML = '';\n  updateTotalPrice();\n  updateLocalStorage();\n  renderCartItem();\n  changeListLength();\n}\n\n// A manipulator function with a card\nfunction handleCartClick(e) {\n  const target = e.target;\n  if (target.closest('.cart-order-decr')) {\n    handleDecrCount(target);\n  } else if (target.closest('.cart-order-incr')) {\n    handleIncrCount(target);\n  } else if (target.classList.contains('cart-remove-btn')) {\n    handleRemoveItem(target);\n  }\n}\n\n// Update price to cart if you change quantity\nfunction updateCartItem(cartItem, item) {\n  const totalPriceElement = cartItem.querySelector('.cart-order-price');\n  const quantityElement = cartItem.querySelector('.cart-order-quantity');\n\n  const numericPrice = parseFloat(item.price.replace('$', ''));\n\n  totalPriceElement.textContent = `$${(numericPrice * item.quantity).toFixed(\n    2\n  )}`;\n  quantityElement.textContent = item.quantity;\n\n  updateTotalPrice();\n  updateLocalStorage();\n}\n\n// Update Total Price in right section\nfunction updateTotalPrice() {\n  const total = cart.reduce(\n    (sum, item) =>\n      sum + parseFloat(item.price.replace('$', '')) * item.quantity,\n    0\n  );\n\n  totalElement.textContent = `$${Number(total.toFixed(2))}`;\n}\n\nexport { cartOrder, handleClearCart };\n","import { getOrders, createOrder } from '../api-servise/api-service-basic';\nimport AWN from 'awesome-notifications';\nimport 'awesome-notifications/dist/style.css';\nimport { showCheckoutModal } from '../modals';\nimport { showModalFirstCase, showModalSecondCase } from '../modals';\nimport { cartOrder, handleClearCart } from '../cart-page-js/cart-order-list';\nimport { hideLoader, showLoader } from '../helpers/loaders';\n\nconst checkoutForm = document.getElementById('checkoutForm');\nconst loader = document.querySelector('.loader');\n// let cart = JSON.parse(localStorage.getItem('cartItems')) || [];\n\nconst imgModal = document.querySelector('.modal-cart-img');\n\ncheckoutForm.addEventListener('submit', function (event) {\n  event.preventDefault();\n\n  const emailInput = document.querySelector('.cart-basket-input');\n  const email = event.currentTarget.cartsubmit.value.trim().toLowerCase();\n  const isValidEmail = emailInput.checkValidity();\n\n  if (!isValidEmail) {\n    alert('Будь ласка, введіть дійсну електронну адресу.');\n    return;\n  }\n\n    const globalOptionsCheck = {\n    labels: { warning: 'Warning' },\n    icons: { warning: '<i class=\"fas fa-exclamation-triangle\"></i>' },\n    colors: { warning: '#FFA500' },\n    maxNotifications: 1,\n    durations: { global: 2000 },\n  };\n\n  const regex = /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}/;\n  if (!email.match(regex)) {\n    emailInput.style.borderColor = 'red';\n    new AWN().warning('Please enter a correct email', globalOptionsCheck);\n    return;\n  }\n\n  emailInput.style.borderColor = '#e8e8e2';\n  showLoader();\n  const data = localStorage.getItem('cartItems');\n  const imgForModal = JSON.parse(data);\n  imgModal.setAttribute('src', imgForModal[0].img);\n  const cart = JSON.parse(data).map(({ id, quantity, img }) => {\n    return { productId: id, amount: quantity };\n  });\n\n  const order = {\n    email: email,\n    products: cart,\n  };\n\n  createOrder(order)\n    .then(data => {\n      if (data.status === 201) {\n        hideLoader();\n        handleClearCart();\n        showCheckoutModal();\n        checkoutForm.reset();\n      }\n    })\n    .catch(e => {\n      hideLoader();\n      new AWN().warning('Something went wrong', globalOptionsCheck);\n    });\n});\n"],"names":["KEY","headerCounter","loadStorage","key","serializedState","error","changeCounter","orderList","cartListSection","cartEmptySection","clearCartBtn","cartCount","cartTotalRight","totalElement","cart","updateLocalStorage","renderCartItem","updateTotalPrice","changeListLength","handleCartClick","handleClearCart","cartOrder","item","sprite","handleDecrCount","target","cartItem","index","updateCartItem","handleIncrCount","handleRemoveItem","totalPriceElement","quantityElement","numericPrice","total","sum","checkoutForm","imgModal","event","emailInput","email","globalOptionsCheck","regex","AWN","showLoader","data","imgForModal","id","quantity","img","createOrder","hideLoader","showCheckoutModal","e"],"mappings":"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"}